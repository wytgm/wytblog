"use strict";const{stripHTML:stripHTML,escapeHTML:escapeHTML,prettyUrls:prettyUrls}=require("hexo-util"),crypto=require("crypto");hexo.extend.helper.register("toStar",(function(e){let t="";for(let r=0;r<Math.floor(e);r++)t+='<i class="fa-solid fa-star"></i>';e-Math.floor(e)!=0&&(t+='<i class="fa-solid fa-star-half-alt"></i>');for(let r=0;r<5-Math.ceil(e);r++)t+='<i class="fa-regular fa-star"></i>';return t})),hexo.extend.helper.register("page_description",(function(){const{config:e,page:t}=this;let r=t.description||t.content||t.title||e.description;if(r)return r=escapeHTML(stripHTML(r).substring(0,150).trim()).replace(/\n/g," "),r})),hexo.extend.helper.register("get_page_fill_description",(function(){const{config:e,page:t}=this;let r=t.content||t.description||t.title||e.description;if(r){const e=/<h[1-6][^>]*>(.*?)<\/h[1-6]>/g,t=[];let i;for(;i=e.exec(r);)t.push(i[0]);const n=t.map((e=>e.replace(/<a[^>]*>.*?<\/a>/g,"").replace(/<\/?[^>]+>|&|:|;|quot;|，|,|“|”|"|'|#/g,""))),o=/<div[^>]*class="?post-ai-description"?.*?>[\s\S]*?<\/div>/gi;return r=r.replace(o,""),r=escapeHTML(stripHTML(r).trim()).replace(/\n/g," ").replace(/[^\u4e00-\u9fa5]/gi,""),n.join(", ")+r}})),hexo.extend.helper.register("cloudTags",(function(e={}){const t=this;let r=e.source;const i=e.minfontsize,n=e.maxfontsize,o=e.limit,s=e.unit||"px",a=e.color||!1,l=e.highlightTags||[];let c="";o>0&&(r=r.limit(o));const h=[];r.sort("length").forEach((e=>{const{length:t}=e;h.includes(t)||h.push(t)}));const p=h.length-1;return r.sort("name").forEach((e=>{const r=p?h.indexOf(e.length)/p:0;let o=`font-size: ${parseFloat((i+(n-i)*r).toFixed(2))}${s};`;if(a){o+=` color: ${"rgb("+Math.floor(201*Math.random())+", "+Math.floor(201*Math.random())+", "+Math.floor(201*Math.random())+")"};`}l.find((t=>t===e.name))&&(o+=" font-weight: 500; color: var(--anzhiyu-lighttext)"),c+=`<a href="${t.url_for(e.path)}" style="${o}">${e.name}<sup>${e.length}</sup></a>`})),c})),hexo.extend.helper.register("urlNoIndex",(function(e=null){return prettyUrls(e||this.url,{trailing_index:!1,trailing_html:!1})})),hexo.extend.helper.register("md5",(function(e){return crypto.createHash("md5").update(decodeURI(this.url_for(e))).digest("hex")})),hexo.extend.helper.register("injectHtml",(function(e){let t="";if(!e)return"";for(let r=0;r<e.length;r++)t+=e[r];return t})),hexo.extend.helper.register("findArchivesTitle",(function(e,t,r){if(e.year){return r(e.month?`${e.year}-${e.month}`:`${e.year}`,e.month?hexo.theme.config.aside.card_archives.format:"YYYY")}const i=this._p("page.archives");if(!t)return i;const n=e=>{for(const t in e)if("object"==typeof e[t]&&n(e[t]),/\/archives\//.test(e[t]))return t};return n(t)||i}));